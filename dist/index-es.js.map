{"version":3,"file":"index-es.js","sources":["../src/buildGetJSONWithFetch.js","../src/index-es.js"],"sourcesContent":["/**\n * @typedef {JSONValue[]} JSONArray\n */\n/**\n * @typedef {null|boolean|number|string|JSONArray|{[key: string]: JSONValue}} JSONValue\n */\n\n/**\n* @callback SimpleJSONCallback\n* @param {...JSONValue} json\n* @returns {void}\n*/\n\n/**\n* @callback SimpleJSONErrback\n* @param {Error} err\n* @param {string|string[]} jsonURL\n* @returns {JSONValue}\n*/\n\n/**\n * @typedef {((\n *   jsonURL: string|string[],\n *   cb?: SimpleJSONCallback,\n *   errBack?: SimpleJSONErrback\n * ) => Promise<JSONValue>) & {\n *   _fetch?: import('./index-polyglot.js').SimpleFetch,\n *   hasURLBasePath?: boolean,\n *   basePath?: string|false\n * }} getJSONCallback\n */\n\n/**\n * @param {object} [cfg]\n * @param {import('./index-polyglot.js').SimpleFetch} [cfg.fetch]\n * @returns {getJSONCallback}\n */\nfunction buildGetJSONWithFetch ({\n  // eslint-disable-next-line no-shadow\n  fetch = typeof window !== 'undefined' ? window.fetch : self.fetch\n} = {}) {\n  /**\n  * @type {getJSONCallback}\n  */\n  return async function getJSON (jsonURL, cb, errBack) {\n    try {\n      if (Array.isArray(jsonURL)) {\n        const arrResult = await Promise.all(jsonURL.map((url) => {\n          return /** @type {getJSONCallback} */ (getJSON)(url);\n        }));\n        if (cb) {\n          // eslint-disable-next-line n/callback-return, n/no-callback-literal, promise/prefer-await-to-callbacks\n          cb(...arrResult);\n        }\n        return arrResult;\n      }\n      const resp = await fetch(jsonURL);\n      const result = await resp.json();\n      return typeof cb === 'function'\n        // eslint-disable-next-line promise/prefer-await-to-callbacks\n        ? cb(result)\n        : result;\n    // https://github.com/bcoe/c8/issues/135\n    /* c8 ignore next */\n    } catch (err) {\n      const e = /** @type {Error} */ (err);\n      e.message += ` (File: ${jsonURL})`;\n      if (errBack) {\n        return errBack(e, jsonURL);\n      }\n      throw e;\n    // https://github.com/bcoe/c8/issues/135\n    /* c8 ignore next */\n    }\n  /* c8 ignore next */\n  };\n}\n\nexport {buildGetJSONWithFetch};\n","import {buildGetJSONWithFetch} from './buildGetJSONWithFetch.js';\n\nconst getJSON = buildGetJSONWithFetch();\n\n/**\n * For polymorphism with Node.\n * @returns {getJSON}\n */\nconst buildGetJSON = () => {\n  return getJSON;\n};\n\nexport {getJSON, buildGetJSON};\n"],"names":["_await","value","then","direct","Promise","resolve","_invoke","body","result","_catch","recover","e","buildGetJSONWithFetch","_ref","arguments","length","undefined","_ref$fetch","fetch","window","self","getJSON","jsonURL","cb","errBack","_exit","Array","isArray","all","map","url","arrResult","apply","_toConsumableArray","_result","resp","json","err","message","concat","reject","buildGetJSON"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAgDO,SAAAA,OAAgBC,KAAK,EAAEC,IAAI,EAAEC,MAAM,EAAE;AAC3C,EAAA,IAAIA,MAAM,EAAE;AACX,IAAA,OAAOD,IAAI,GAAGA,IAAI,CAACD,KAAK,CAAC,GAAGA,KAAK,CAAA;AAClC,GAAA;AACA,EAAA,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAACC,IAAI,EAAE;AAC1BD,IAAAA,KAAK,GAAGG,OAAO,CAACC,OAAO,CAACJ,KAAK,CAAC,CAAA;AAC/B,GAAA;EACA,OAAOC,IAAI,GAAGD,KAAK,CAACC,IAAI,CAACA,IAAI,CAAC,GAAGD,KAAK,CAAA;AACvC,CAAA;AAqcO,SAAAK,OAAiBC,CAAAA,IAAI,EAAEL,IAAI,EAAE;AACnC,EAAA,IAAIM,MAAM,GAAGD,IAAI,EAAE,CAAA;AACnB,EAAA,IAAIC,MAAM,IAAIA,MAAM,CAACN,IAAI,EAAE;AAC1B,IAAA,OAAOM,MAAM,CAACN,IAAI,CAACA,IAAI,CAAC,CAAA;AACzB,GAAA;EACA,OAAOA,IAAI,CAACM,MAAM,CAAC,CAAA;AACpB,CAAA;AAWO,SAAAC,MAAgBF,CAAAA,IAAI,EAAEG,OAAO,EAAE;EACrC,IAAI;AACH,IAAA,IAAIF,MAAM,GAAGD,IAAI,EAAE,CAAA;GACnB,CAAC,OAAMI,CAAC,EAAE;IACV,OAAOD,OAAO,CAACC,CAAC,CAAC,CAAA;AAClB,GAAA;AACA,EAAA,IAAIH,MAAM,IAAIA,MAAM,CAACN,IAAI,EAAE;IAC1B,OAAOM,MAAM,CAACN,IAAI,CAAC,KAAK,CAAC,EAAEQ,OAAO,CAAC,CAAA;AACpC,GAAA;AACA,EAAA,OAAOF,MAAM,CAAA;AACd,CAAA;AAvhBA,SAASI,qBAAqBA,GAGtB;AAAA,EAAA,IAAAC,IAAA,GAAAC,SAAA,CAAAC,MAAA,GAAA,CAAA,IAAAD,SAAA,CAAA,CAAA,CAAA,KAAAE,SAAA,GAAAF,SAAA,CAAA,CAAA,CAAA,GAAJ,EAAE;IAAAG,UAAA,GAAAJ,IAAA,CADJK,KAAK;AAALA,IAAAA,KAAK,GAAAD,UAAA,KAAA,KAAA,CAAA,GAAG,OAAOE,MAAM,KAAK,WAAW,GAAGA,MAAM,CAACD,KAAK,GAAGE,IAAI,CAACF,KAAK,GAAAD,UAAA,CAAA;AAEjE;AACF;AACA;AACE,EAAA,OAAA,SAAsBI,OAAOA,CAAEC,OAAO,EAAEC,EAAE,EAAEC,OAAO,EAAA;IAAA,IAAE;AAAA,MAAA,IAAAC,KAAA,GAAA,KAAA,CAAA;MAAA,OAAAzB,MAAA,CAAAS,MAAA,CAC/C,YAAA;AAAA,QAAA,OAAAH,OAAA,CAAA,YAAA;AAAA,UAAA,IACEoB,KAAK,CAACC,OAAO,CAACL,OAAO,CAAC,EAAA;AAAA,YAAA,OAAAtB,MAAA,CACAI,OAAO,CAACwB,GAAG,CAACN,OAAO,CAACO,GAAG,CAAC,UAACC,GAAG,EAAK;cACvD,sCAAuCT,OAAO,CAAES,GAAG,CAAA;AAAC,gBAAA;aACrD,CAAC,CAAC,EAAA,UAFGC,SAAS,EAAA;AAGf,cAAA,IAAIR,EAAE,EAAE;AACN;AACAA,gBAAAA,EAAE,CAAAS,KAAA,CAAA,KAAA,CAAA,EAAAC,kBAAA,CAAIF,SAAS,CAAC,CAAA,CAAA;AAClB,eAAA;cAACN,KAAA,GAAA,IAAA,CAAA;AAAA,cAAA,OACMM,SAAS,CAAA;AAAA,aAAA,CAAA,CAAA;AAAA,WAAA;AAAA,SAAA,EAAA,UAAAG,OAAA,EAAA;UAAA,OAAAT,KAAA,GAAAS,OAAA,GAAAlC,MAAA,CAECkB,KAAK,CAACI,OAAO,CAAC,EAAA,UAA3Ba,IAAI,EAAA;YAAA,OAAAnC,MAAA,CACWmC,IAAI,CAACC,IAAI,EAAE,YAA1B5B,MAAM,EAAA;cACZ,OAAO,OAAOe,EAAE,KAAK,UAAA;AACnB;AAAA,gBACEA,EAAE,CAACf,MAAM,CAAC,GACVA,MAAM,CAAA;AACZ;AACA;AAAA,aAAA,CAAA,CAAA;AAAA,WAAA,CAAA,CAAA;AAAA,SAAA,CAAA,CAAA;OACC,EAAA,UAAQ6B,GAAG,EAAE;QACZ,IAAM1B,CAAC,uBAAyB0B,GAAI,CAAA;AACpC1B,QAAAA,CAAC,CAAC2B,OAAO,IAAA,UAAA,CAAAC,MAAA,CAAejB,OAAO,EAAG,GAAA,CAAA,CAAA;AAClC,QAAA,IAAIE,OAAO,EAAE;AACX,UAAA,OAAOA,OAAO,CAACb,CAAC,EAAEW,OAAO,CAAC,CAAA;AAC5B,SAAA;AACA,QAAA,MAAMX,CAAC,CAAA;AACT;AACA;OACC,CAAA,CAAA,CAAA;AACH;AACA,KAAC,QAAAA,CAAA,EAAA;AAAA,MAAA,OAAAP,OAAA,CAAAoC,MAAA,CAAA7B,CAAA,CAAA,CAAA;AAAA,KAAA;AAAA,GAAA,CAAA;AACH;;AC1EA,IAAMU,OAAO,GAAGT,qBAAqB,GAAE;;AAEvC;AACA;AACA;AACA;AACA,IAAM6B,YAAY,GAAG,SAAfA,YAAYA,GAAS;AACzB,EAAA,OAAOpB,OAAO,CAAA;AAChB;;;;"}