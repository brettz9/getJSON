{"version":3,"file":"index.js","sources":["../src/buildGetJSONWithFetch.js","../src/index.js"],"sourcesContent":["/**\n * @typedef {JSONValue[]} JSONArray\n */\n/**\n * @typedef {null|boolean|number|string|JSONArray|{[key: string]: JSONValue}} JSONValue\n */\n\n/**\n* @callback SimpleJSONCallback\n* @param {...JSONValue} json\n* @returns {void}\n*/\n\n/**\n* @callback SimpleJSONErrback\n* @param {Error} err\n* @param {string|string[]} jsonURL\n* @returns {JSONValue}\n*/\n\n/**\n * @typedef {((\n *   jsonURL: string|string[],\n *   cb?: SimpleJSONCallback,\n *   errBack?: SimpleJSONErrback\n * ) => Promise<JSONValue>) & {\n *   _fetch?: import('./index-polyglot.js').SimpleFetch,\n *   hasURLBasePath?: boolean,\n *   basePath?: string|false\n * }} getJSONCallback\n */\n\n/**\n * @param {object} [cfg]\n * @param {import('./index-polyglot.js').SimpleFetch} [cfg.fetch]\n * @returns {getJSONCallback}\n */\nfunction buildGetJSONWithFetch ({\n  // eslint-disable-next-line no-shadow\n  fetch = typeof window !== 'undefined' ? window.fetch : self.fetch\n} = {}) {\n  /**\n  * @type {getJSONCallback}\n  */\n  return async function getJSON (jsonURL, cb, errBack) {\n    try {\n      if (Array.isArray(jsonURL)) {\n        const arrResult = await Promise.all(jsonURL.map((url) => {\n          return /** @type {getJSONCallback} */ (getJSON)(url);\n        }));\n        if (cb) {\n          // eslint-disable-next-line n/callback-return, n/no-callback-literal, promise/prefer-await-to-callbacks\n          cb(...arrResult);\n        }\n        return arrResult;\n      }\n      const resp = await fetch(jsonURL);\n      const result = await resp.json();\n      return typeof cb === 'function'\n        // eslint-disable-next-line promise/prefer-await-to-callbacks\n        ? cb(result)\n        : result;\n    // https://github.com/bcoe/c8/issues/135\n    /* c8 ignore next */\n    } catch (err) {\n      const e = /** @type {Error} */ (err);\n      e.message += ` (File: ${jsonURL})`;\n      if (errBack) {\n        return errBack(e, jsonURL);\n      }\n      throw e;\n    // https://github.com/bcoe/c8/issues/135\n    /* c8 ignore next */\n    }\n  /* c8 ignore next */\n  };\n}\n\nexport {buildGetJSONWithFetch};\n","import {buildGetJSONWithFetch} from './buildGetJSONWithFetch.js';\n\nconst getJSON = buildGetJSONWithFetch();\n\nexport default getJSON;\n"],"names":["_await","value","then","direct","Promise","resolve","_invoke","body","result","_catch","recover","e","buildGetJSONWithFetch","_ref","arguments","length","undefined","_ref$fetch","fetch","window","self","getJSON","jsonURL","cb","errBack","_exit","Array","isArray","all","map","url","arrResult","apply","_toConsumableArray","_result","resp","json","err","message","concat","reject"],"mappings":"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"}